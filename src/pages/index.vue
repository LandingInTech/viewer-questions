<template>
  <div class="app">
    <meta http-equiv="refresh" content="120" />

    <div v-if="questions.length">
      <div class="question-wrapper">
        <div class="question-box">
          <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="100" height="61" viewBox="0 0 100 61">
            <defs>
              <clipPath id="clip-Artboard_14">
                <rect width="100" height="61"/>
              </clipPath>
            </defs>
            <g id="Artboard_14" data-name="Artboard â€“ 14" clip-path="url(#clip-Artboard_14)">
              <g id="Group_42" data-name="Group 42" transform="translate(-99 -947)">
                <path id="Union_125" data-name="Union 125" d="M0,39.6V38.119H100V39.6Zm50.351-6.9v-.029h-.466V32.7a.466.466,0,1,1-.932,0V31.654a.466.466,0,0,1,.793-.332V29.808a7.49,7.49,0,0,1-5.215-2.489q-.176-.192-.34-.393c-.817-.089-2.77-.3-5.4-.6v1.58a.467.467,0,0,1,.839.281v1.048a.466.466,0,1,1-.932,0v-.029h-.466v.029a.466.466,0,1,1-.932,0V28.189a.467.467,0,0,1,.793-.333V26.25c-1.222-.138-2.571-.291-4.005-.456a3.815,3.815,0,0,1,.292.411,3.881,3.881,0,0,1,.324.651,4.16,4.16,0,0,1,0,2.982,3.89,3.89,0,0,1-.324.652,3.726,3.726,0,0,1-.428.566,3.543,3.543,0,0,1-.519.468,3.418,3.418,0,0,1-.6.354,3.255,3.255,0,0,1-2.732,0,3.459,3.459,0,0,1-.6-.354,3.638,3.638,0,0,1-.519-.468,3.847,3.847,0,0,1-.428-.566,3.96,3.96,0,0,1-.324-.652,4.173,4.173,0,0,1,0-2.982,3.951,3.951,0,0,1,.324-.651,3.722,3.722,0,0,1,.848-.958c-3.369-.4-6.94-.836-10.308-1.273C10.991,22.921,4.056,21.866.623,21.328c-1.448-.227.391-.641.391-.641l41.233,1.033c-.006-.142-.01-.284-.01-.428a9.283,9.283,0,0,1,.264-2.2c-1.587-.174-5.525-.614-8.919-1.054-3.061-.4-5.679-.8-6.976-1-.547-.085.148-.242.148-.242l16.439.412a8.555,8.555,0,0,1,1.338-1.94,7.561,7.561,0,0,1,4.385-2.4L49.976,0l1.059,12.833A7.545,7.545,0,0,1,55.6,15.265,8.546,8.546,0,0,1,56.939,17.2l16.284-.409s.695.157.148.242c-1.3.2-3.915.6-6.976,1-3.289.427-7.091.853-8.766,1.037a9.289,9.289,0,0,1,.267,2.222c0,.143,0,.285-.009.427l41.147-1.031s1.84.414.392.641c-3.434.538-10.367,1.593-18.473,2.646-3.308.429-6.812.859-10.129,1.252A3.942,3.942,0,0,1,72.3,28.347a3.523,3.523,0,1,1-7.02,0,4.015,4.015,0,0,1,.918-2.58c-1.467.169-2.848.327-4.1.468v1.427a.466.466,0,0,1,.839.28v1.048a.466.466,0,1,1-.932,0V28.96h-.466v.029a.466.466,0,1,1-.932,0V27.941a.466.466,0,0,1,.793-.332v-1.3c-2.606.292-4.568.507-5.449.6-.112.138-.228.273-.348.4a7.5,7.5,0,0,1-5.159,2.487v1.569a.466.466,0,0,1,.839.28V32.7a.466.466,0,1,1-.932,0Zm16.31-4a2.134,2.134,0,1,0,2.13-2.266A2.2,2.2,0,0,0,66.66,28.7ZM30.639,26.609a2.122,2.122,0,0,0-.677.486,2.269,2.269,0,0,0-.457.721,2.407,2.407,0,0,0,0,1.764,2.259,2.259,0,0,0,.457.721,2.105,2.105,0,0,0,.677.485,2.017,2.017,0,0,0,1.658,0,2.105,2.105,0,0,0,.677-.485,2.257,2.257,0,0,0,.456-.721,2.407,2.407,0,0,0,0-1.764,2.266,2.266,0,0,0-.456-.721,2.122,2.122,0,0,0-.677-.486,2.026,2.026,0,0,0-1.658,0Zm14.937-8.594a1.044,1.044,0,0,0-.365.741,1.42,1.42,0,0,0,.365.9l3.3.067H51.39l3.281-.067a1.408,1.408,0,0,0,.365-.9,1.044,1.044,0,0,0-.365-.741,7.838,7.838,0,0,0-3.138-1.436,5.909,5.909,0,0,0-1.306-.1,7.712,7.712,0,0,0-1.37.086h-.019A7.57,7.57,0,0,0,45.576,18.015Z" transform="translate(99 947)" fill="#fc354c"/>
                <path id="Path_178" data-name="Path 178" d="M9-.1q.366.635,1.076,1.9H6.136Q5.815,1.2,5.128,0H1.694A1.534,1.534,0,0,1,.5-.537,1.74,1.74,0,0,1,0-1.807v-14.4a1.794,1.794,0,0,1,.5-1.27,1.566,1.566,0,0,1,1.191-.513H8.448a1.614,1.614,0,0,1,1.191.513,1.841,1.841,0,0,1,.481,1.27v14.4a1.9,1.9,0,0,1-.3,1.05A1.758,1.758,0,0,1,9-.1ZM3.365-3.589H6.754V-14.4H3.365V-3.589Zm20.262-14.4V-1.807a1.785,1.785,0,0,1-.481,1.27A1.58,1.58,0,0,1,21.956,0H15.2a1.534,1.534,0,0,1-1.191-.537,1.74,1.74,0,0,1-.5-1.27V-17.993h3.365v14.4h3.388v-14.4ZM37.135-14.4v-3.589H27.015V0H37.135V-3.589H30.381V-7.2h5.083v-3.589H30.381V-14.4ZM47.277-12.6V-14.4H43.889v3.613h5.083a1.614,1.614,0,0,1,1.191.513,1.841,1.841,0,0,1,.481,1.27v7.2a1.785,1.785,0,0,1-.481,1.27A1.58,1.58,0,0,1,48.971,0H42.217a1.534,1.534,0,0,1-1.191-.537,1.74,1.74,0,0,1-.5-1.27V-5.4h3.365v1.807h3.388V-7.2h-5.06a1.566,1.566,0,0,1-1.191-.513,1.824,1.824,0,0,1-.5-1.294v-7.2a1.794,1.794,0,0,1,.5-1.27,1.566,1.566,0,0,1,1.191-.513h6.754a1.614,1.614,0,0,1,1.191.513,1.841,1.841,0,0,1,.481,1.27V-12.6Zm16.873-5.4H54.031V-14.4H57.4V0h3.388V-14.4H64.15Zm3.388,0H70.9V0H67.538V-17.993Zm16.873,1.782v14.4a1.785,1.785,0,0,1-.481,1.27A1.58,1.58,0,0,1,82.74,0H75.986A1.534,1.534,0,0,1,74.8-.537a1.74,1.74,0,0,1-.5-1.27v-14.4a1.794,1.794,0,0,1,.5-1.27,1.566,1.566,0,0,1,1.191-.513H82.74a1.614,1.614,0,0,1,1.191.513A1.841,1.841,0,0,1,84.412-16.211ZM77.658-3.589h3.388V-14.4H77.658V-3.589ZM97.919-16.211V0H94.554V-14.4H91.165V0H87.8V-17.993h8.448a1.614,1.614,0,0,1,1.191.513A1.841,1.841,0,0,1,97.919-16.211Z" transform="translate(99 1006.167)" fill="#fc354c"/>
              </g>
            </g>
          </svg>
        </div>

        <div v-for="question in questions" :key="question.id" class="question">
            <p class="question-text">{{question.question}}</p>
            <p class="question-author"> {{question.username}} </p>
          </div>
      </div>
    </div>
  </div>
</template>

<script>
/** 
  GraphQL Queries
*/
const GET_QUESTIONS = `
  query GetTodos {
  allQuestions(where:{ isShown: true AND:{wasAsked_not: true} }) {
      username
      question
    }
  }
`;


function graphql(query, variables = {}) {
  return fetch('http://localhost:3000/admin/api', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
    },
    body: JSON.stringify({
      variables,
      query,
    }),
  }).then(function(result) {
    return result.json();
  });
}

export default {
  head: {
    title: 'Landing In Tech Questions',
  },
  data() {
    return {
      newQuestion: '',
    };
  },
  // Get the question items on server side
  async asyncData() {
    const { data } = await graphql(GET_QUESTIONS);

    return {
      questions: data.allQuestions,
    };
  },

  methods: {
    async getQuestions() {
      const { data } = await graphql(GET_QUESTIONS);
      this.questions = data.allQuestions;
    },
  },
};
</script>


<style>
*,
*:before,
*:after {
  box-sizing: border-box;
}
body,
html {
  margin: 0;
  padding: 0;
}

body {
  font-family: 'Montserrat', sans-serif;;
}

.question-wrapper {
  display: flex;
  background-color: #37275C;
  font-size: medium;
  animation: 5s linear forwards fadein;
}

.question-box {
  display: flex;
  justify-content: center;
  align-items: center;
  background-color: #251333;
  padding: 1rem;
}

.question {
  padding: .5rem 1.5rem;
}

.question-text {
  color: #84FAB1;

}

.question-author {
  color: #FAA0AB;
}

@keyframes fadein {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}


</style>